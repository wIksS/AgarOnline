<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8" />
    <link rel="stylesheet" types="text/css" href="styles.css" />
    <canvas id="gameCanvas" width="1300" height="600" style="border:1px solid #000000;"></canvas>
</head>
<body>
    <!--<div class="circle"></div>-->

    <script src="Scripts/jquery-1.12.4.js"></script>
    <script src="Scripts/jquery-ui-1.12.1.js"></script>
    <script src="Scripts/jquery.signalR-2.2.1.js"></script>
    <script src="http://localhost:17962/signalr/hubs"></script>
    <script src="Scripts/fabric.js"></script>
    <script src="circle.js"></script>
    <script src="player.js"></script>
    <script src="game.js"></script>
    <script src="playersHub.js"></script>
    <script>
        let canvas;
        let game;
        let playersHub;

        $(function () {
            canvas = new fabric.Canvas('gameCanvas');
            game = new Game(canvas);
            let playerHub = $.connection.playerHub;
            $.connection.hub.url = "http://localhost:17962/signalr";
            playersHub = new PlayersHub(playerHub, game);
            
            $.connection.hub.start().done(function () {
                playerHub.server.spawnPlayer();
            });            
        });

        $("body").mousemove(function (event) {
            var player = game.getPlayer(playersHub.currentPlayer.id);
            if (player) {
                playersHub.hub.server.updatePlayer({ id: player.id, mouseLeft: event.pageX, mouseTop: event.pageY});
            }
        });
    </script>
</body>
</html>
